\begin{tad}{\tadNombre{Sistema}}
	\tadGeneros{sistema}
	
	\tadExporta{}
	
	\tadIgualdadObservacional{s}{s'}{sistema}{mapa(s) \igobs mapa(s') $\land$ jugadores(s) \igobs jugadores(s') $\land$  ($\forall$ j : jugadores(s)) (sancionesJugador(j,s) \igobs sancionesJugador(j,s') $\land$ sancionesJugador(j,s) $<$ 5 $\impluego$ (conectado?(j,s) \igobs conectado?(j,s') $\land$ posicionJugador(j,s) \igobs posicionJugador(j,s') $\land$ pokemonsCapturados(j,s) \igobs pokemonsCapturados(j,s') $\land$ conectado?(j,s) $\impluego$ ($\forall$ p : posiciones(mapa(s))) (movsLejosDePos(j,p,s) \igobs movsLejosDePos(j,p,s')))) $\land$ ($\forall$ p : posiciones(mapa(s))) (hayPokemon?(p,s) \igobs hayPokemon?(p,s') $\land$ hayPokemon?(p,s) $\impluego$ pokemonEnPos(p,s) \igobs pokemonEnPos(p,s'))}
	
	\tadGeneradores
		\tadAlinearFunciones{desconectarJugador~}{sistema/s, jugador/j, posicion/p}

		\tadOperacion{crearSistema}{mapa/m}{sistema}{}

		\tadOperacion{registrarJugador}{sistema/s, jugador/j}{sistema}{$\neg$ j $\in$ jugadores(s)}

		\tadOperacion{conectarJugador}{sistema/s, jugador/j, posicion/p}{sistema}{(j $\in$ jugadores(s) $\yluego \neg$eliminado?(j,s)  $\yluego \neg$conectado?(j,s)) $\land$ p $\in$ posiciones(mapa(s))}
		\tadOperacion{desconectarJugador}{sistema/s, jugador/j}{sistema}{j $\in$ jugadores(s) $\yluego \neg$eliminado?(j,s)  $\yluego$ conectado?(j,s)}

		
		\tadOperacion{moverJugador}{sistema/s, jugador/j, posicion/p}{sistema}{(j $\in$ jugadores(s) $\yluego \neg$eliminado?(j,s)  $\yluego$conectado?(j,s)) $\land$ p $\in$ posiciones(mapa(s))}

		\tadOperacion{agregarPokemon}{sistema/s, pokemon, posicion/p}{sistema}{p $\in$ posiciones(mapa(s)) $\yluego$ ($\neg$(hayPokemon?(p, s)) $\land$ pokemonsCerca?(p, posiciones(mapa(s)), s))}
		
	\tadObservadores
		\tadAlinearFunciones{pokemonsCapturados~}{jugador/j, posicion/p, sistema/s}

		\tadOperacion{mapa}{sistema}{mapa}{}

		\tadOperacion{jugadores}{sistema}{conj(jugador)}{}
		\tadOperacion{conectado?}{jugador/j, sistema/s}{bool}{j $\in$ jugadores(s) $\yluego \neg$eliminado?(j,s)}
		\tadOperacion{posicionJugador}{jugador/j, sistema/s}{posicion}{j $\in$ jugadores(s) $\yluego \neg$eliminado?(j,s) $\yluego$conectado(j,s)}
		\tadOperacion{sancionesJugador}{jugador/j, sistema/s}{nat}{j $\in$ jugadores(s)}
		\tadOperacion{pokemonsCapturados}{jugador/j, sistema/s}{multiconj(pokemon)}{j $\in$ jugadores(s) $\yluego \neg$eliminado?(j,s)}
		\tadOperacion{hayPokemon?}{posicion/p, sistema/s}{bool}{p $\in$ posiciones(mapa(s))}
		\tadOperacion{pokemonEnPos}{posicion/p, sistema/s}{pokemon}{p $\in$ posiciones(mapa(s)) $\yluego$ hayPokemon?(p,s)}
		\tadOperacion{movsLejosDePos}{jugador/j, posicion/p, sistema/s}{nat}{j $\in$ jugadoresConectados(jugadores(s)), p $\in$ posiciones(mapa(s))}

	\tadOtrasOperaciones
		\tadAlinearFunciones{pokemonsCapturadosPorGrupo~}{jugador/j, posiciones/ps, sistema/s}
		\tadOperacion{eliminado?}{jugador/j, sistema/s}{bool}{j $\in$ jugadores(s)}

		\tadOperacion{rareza}{pokemon/pk, sistema/s}{nat}{0 $<$ $\#$todosLosPokemons(s)}

		\tadOperacion{todosLosPokemons}{sistema}{multiconj(pokemon)}{}
		\tadOperacion{pokemonsEnArea}{conj(posicion)/ps, sistema/s}{multiconj(pokemon)}{ps $\subseteq$ posiciones(mapa(s))}
		\tadOperacion{pokemonsCapturadosPorGrupo}{conj(jugador)/js, sistema/s}{multiconj(pokemon)}{js $\subseteq$ jugadores(s)}
		
		\tadOperacion{distancia}{posicion, posicion}{nat}{}
		
		\tadOperacion{\argumento $\div$ \argumento}{nat/n, nat/m}{nat}{0 $<$ m}
		\tadOperacion{raizCuadrada}{nat}{nat}{}
		\tadOperacion{encontrarRaiz}{nat/n, nat/m}{nat}{m $\leq$ n}
		
		\tadOperacion{capturaPokemon?}{jugador/j, posiciones/ps, sistema/s}{bool}{j $\in$ jugadoresConectados(jugadores(s), s) $\land$ ps $\subseteq$ posiciones(mapa(s))}
		\tadOperacion{pokemonACapturar}{jugador/j, posiciones/ps, sistema/s}{bool}{j $\in$ jugadoresConectados(jugadores(s), s) $\land$ ps $\subseteq$ posiciones(mapa(s))}
		\tadOperacion{jugadoresConectados}{conj(jugador)/js, sistema/s}{conj(jugador)}{js $\subseteq$ jugadores(s)} 

		\tadOperacion{pokemonsCerca?}{posicion/p, posiciones/ps, sistema/s}{bool}{p $\in$ posiciones(mapa(s)) $\land$ ps $\subseteq$ posiciones(mapa(s))}

	\tadAxiomas
		\tadAxioma{mapa(crearSistema(m))}{m}
		\tadAxioma{mapa(registrarJugador(s,j))}{mapa(s)}
		\tadAxioma{mapa(conectarJugador(s,j,p))}{mapa(s)}
		\tadAxioma{mapa(desconectarJugador(s,j))}{mapa(s)}
		\tadAxioma{mapa(moverJugador(s,j,p))}{mapa(s)}
		\tadAxioma{mapa(agregarPokemon(s,pk,p))}{mapa(s)}
		
		\tadAxioma{jugadores(crearSistema(m))}{$\emptyset$}
		\tadAxioma{jugadores(registrarJugador(s,j))}{Ag(j,jugadores(s))}
		\tadAxioma{jugadores(conectarJugador(s,j,p))}{jugadores(s)}
		\tadAxioma{jugadores(desconectarJugador(s,j))}{jugadores(s)}
		\tadAxioma{jugadores(moverJugador(s,j,p))}{jugadores(s)}
		\tadAxioma{jugadores(agregarPokemon(s,pk,p))}{jugadores(s)}
		
		\tadAxioma{jugadoresConectados(js, s)}
		{\IF vacio?(js) THEN
			 $\emptyset$
		ELSE
			{\IF $\neg$eliminado?(dameUno(js)) $\yluego$ conectado?(dameUno(js)) THEN
				Ag(dameUnos(js), jugadoresConectados(sinUno(js), s))
			ELSE
				jugadoresConectados(sinUno(js), s)
			FI}
		FI}
		
		\tadAxioma{conectado?(j, registrarJugador(s,j'))}{\IF j = j' THEN false ELSE conectado?(j,s) FI}
		\tadAxioma{conectado?(j, conectarJugador(s,j',p))}{\IF j = j' THEN true ELSE conectado?(j,s) FI}
		\tadAxioma{conectado?(j, desconectarJugador(s,j'))}{\IF j = j' THEN false ELSE conectado?(j,s) FI}
		\tadAxioma{conectado?(j, moverJugador(s,j',p))}{conectado?(j,s)}
		\tadAxioma{conectado?(j, agregarPokemon(s,pk,p))}{conectado?(j,s)}

		\tadAxioma{posicionJugador(j, registrarJugador(s,j'))}{posicionJugador(j,s)}
		\tadAxioma{posicionJugador(j, conectarJugador(s,j',p))}{\IF j = j' THEN p ELSE posicionJugador(j,s) FI}
		\tadAxioma{posicionJugador(j, desconectarJugador(s,j'))}{posicionJugador(j,s)}
		\tadAxioma{posicionJugador(j, moverJugador(s,j',p))}{\IF j = j' THEN p ELSE posicionJugador(j,s) FI}
		\tadAxioma{posicionJugador(j, agregarPokemon(s,pk,p))}{posicionJugador(j,s)}

		\tadAxioma{pokemonsCapturados(j, registrarJugador(s,j'))}{\IF j = j' THEN $\emptyset$ ELSE pokemonsCapturados(j,s) FI}
		\tadAxioma{pokemonsCapturados(j, conectarJugador(s,j',p))}{pokemonsCapturados(j,s)}
		\tadAxioma{pokemonsCapturados(j, desconectarJugador(s,j'))}{pokemonsCapturados(j,s)}
		\tadAxioma{pokemonsCapturados(j, agregarPokemon(s,pk,p))}{pokemonsCapturados(j,s)}
		\tadAxioma{pokemonsCapturados(j, moverJugador(s,j',p))}
		{\IF conectado?(j) $\yluego$ capturaPokemon?(j, posiciones(mapa(s)), moverJugador(s,j',p)) THEN
			Ag(pokemonACapturar(j, posiciones(mapa(s)), moverJugador(s,j',p)), pokemonsCapturados(j, s))
		ELSE
			pokemonsCapturados(j, s)
		FI}

		\tadAxioma{capturaPokemon?(j, ps, s)}
		{\IF vacio?(ps) THEN
			false
		ELSE
			{\IF hayPokemon?(dameUno(ps), s) $\land$ distancia(posicionJugador(j, s), dameUno(ps)) $\leq$ 2 THEN
				$\neg\emptyset$?(jugadoresDisponiblesACapturar(jugadoresConectados(s), dameUno(ps), s)) $\yluego$ j = dameUno(jugadoresDisponiblesACapturar(jugadoresConectados(s), dameUno(ps), s))
			ELSE
				capturaPokemon?(j, sinUno(ps), s)
			FI}
		FI}
		
		\tadAxioma{pokemonACapturar(j, ps, s)}
		{\IF hayPokemon?(dameUno(ps), s) $\land$ distancia(posicionJugador(j, s), dameUno(ps)) $\leq$ 2 THEN
			pokemonEnPos(dameUno(ps), s)
		ELSE
			capturaPokemon?(j, sinUno(ps), s)
		FI}

		\tadAxioma{jugadoresDisponiblesACapturar(js, p, s)}
		{\IF vacio?(js) THEN
			$\emptyset$
		ELSE
			{\IF movsLejosDePos(dameUno(js), s) = 10 THEN
				Ag(dameUno(js), jugadoresDisponiblesACapturar(sinUno(js, p, s)))
			ELSE
				jugadoresDisponiblesACapturar(sinUno(js, p, s))
			FI}
		FI}

		\tadAxioma{movsLejosDePos(j, p, registrarJugador(s,j'))}{\IF j = j' THEN 0 ELSE movsLejosDePos(j, p, s) FI}
		\tadAxioma{movsLejosDePos(j, p, conectarJugador(s,j',p'))}{\IF j = j' THEN 0 ELSE movsLejosDePos(j, p, s) FI}
		\tadAxioma{movsLejosDePos(j, p, desconectarJugador(s,j'))}{\IF j = j' THEN 0 ELSE movsLejosDePos(j, p, s) FI}
		\tadAxioma{movsLejosDePos(j, p, agregarPokemon(s,pk,p'))}{\IF p = p' THEN 0 ELSE movsLejosDePos(j, p, s) FI}

		\tadAxioma{movsLejosDePos(j, p, moverJugador(s,j',p'))}
		{\IF distancia(p, posicionJugador(j, s)) $\leq$ 2 THEN
			{\IF j = j' THEN
				{\IF distancia(p, p') $\leq$ 2 THEN
					movsLejosDePos(j, p ,s)
				ELSE
					0
				FI}
			ELSE
				{\IF distancia(p, p') $\leq$ 2 THEN
					{\IF distancia(p, posicionJugador(j', s)) $\leq$ 2 THEN
						movsLejosDePos(j, p ,s)
					ELSE
						0
					FI}
				ELSE
					1 + movsLejosDePos(j, p ,s)
				FI}
			FI}
		ELSE
			0
		FI}






		\tadAxioma{sancionesJugador(j, registrarJugador(s,j'))}{\IF j = j' THEN 0 ELSE sancionesJugador(j,s) FI}
		\tadAxioma{sancionesJugador(j, conectarJugador(s,j',p))}{sancionesJugador(j,s)}
		\tadAxioma{sancionesJugador(j, desconectarJugador(s,j'))}{sancionesJugador(j,s)}
		\tadAxioma{sancionesJugador(j, moverJugador(s,j',p))}
		{\IF j = j' $\land$ (10 $\leq$ distancia(p, posicionJugador(j,s)) $\lor$ ($\neg$conexion?(p, posicionJugador(j,s), mapa(s)))) THEN 
			1 +	sancionesJugador(j,s)
		ELSE sancionesJugador(j,s) FI}
		\tadAxioma{sancionesJugador(j, agregarPokemon(s,pk,p))}{sancionesJugador(j,s)}


		\tadAxioma{hayPokemon?(p, crearSistema(m))}{false}
		\tadAxioma{hayPokemon?(p, registrarJugador(s,j))}{hayPokemon?(p,s)}
		\tadAxioma{hayPokemon?(p, conectarJugador(s,j,p'))}{hayPokemon?(p,s)}
		\tadAxioma{hayPokemon?(p, desconectarJugador(s,j))}{hayPokemon?(p,s)}
		\tadAxioma{hayPokemon?(p, moverJugador(s,j,p'))}
		{\IF hayPokemon?(p,s) THEN
			$\neg$alguienCapturaPokemon(jugadoresConectados(s), p, moverJugador(s,j,p'))
		ELSE
			false
		FI}
		\tadAxioma{hayPokemon?(p, agregarPokemon(s,pk,p'))}{\IF p = p' THEN true ELSE hayPokemon?(p,s) FI}
		
		\tadAxioma{alguienCapturaPokemon(js, p, s)}
		{\IF vacio?(js) THEN
			false
		ELSE
			{\IF capturaPokemon?(dameUno(js), p, s) THEN
				true
			ELSE
				capturaPokemon?(sinUno(js), p, s)
			FI}
		FI}


		\tadAxioma{pokemonEnPos(p, registrarJugador(s,j))}{pokemonEnPos(p,s)}
		\tadAxioma{pokemonEnPos(p, conectarJugador(s,j,p'))}{pokemonEnPos(p,s)}
		\tadAxioma{pokemonEnPos(p, desconectarJugador(s,j))}{pokemonEnPos(p,s)}
		\tadAxioma{pokemonEnPos(p, moverJugador(s,j,p'))}{pokemonEnPos(p,s)}
		\tadAxioma{pokemonEnPos(p, agregarPokemon(s,pk,p'))}{\IF p = p' THEN pk ELSE pokemonEnPos(p,s) FI}

		\tadAxioma{pokemonsCerca?(p, ps, s)}
		{\IF vacio?(ps) THEN
			false
		ELSE
			{\IF $\neg$(p = dameUno(ps)) $\land$ distancia(p, dameUno(ps)) $<$ 5 $\land$ hayPokemon?(dameUno(ps), s) THEN
				false
			ELSE
				pokemonsCerca?(p, sinUno(ps), s)
			FI}
		FI}

		\tadAxioma{eliminado?(j,s)}{sancionesJugador(j,s) = 5}

		\tadAxioma{rareza(pk, s)}{100 - 100 $\times$ ($\#$(pk,todosLosPokemons(s)) $\div$ $\#$(todosLosPokemons(s)))}

		\tadAxioma{todosLosPokemons(s)}{pokemonsEnArea(posiciones(mapa(s)),s) $\cup$ pokemonsCapturadosPorGrupo(jugadores(s),s)}

		\tadAxioma{pokemonsEnArea(ps, s)}
		{\IF vacio?(ps) THEN
			$\emptyset$
		ELSE
			{\IF hayPokemon?(dameUno(ps), s) THEN
				Ag(pokemonEnPos(dameUno(ps), s), pokemonsEnArea(sinUno(ps),s))
			ELSE
				pokemonsEnArea(sinUno(ps),s)
			FI}
		FI}

		\tadAxioma{pokemonsCapturadosPorGrupo(js, s)}
		{\IF vacio?(js) THEN
			$\emptyset$
		ELSE
			{\IF eliminado?(dameUno(js)) THEN
				pokemonsCapturadosPorGrupo(sinUno(js), s)
			ELSE
				pokemonsCapturados(dameUno(js), s) $\cup$ pokemonsCapturadosPorGrupo(sinUno(js), s)
			FI}
		FI}
		
		
		
		\tadAxioma{distancia(p,p')}
		{\IF $\pi_1$(p) $<$ $\pi_1$(p')  THEN
			distancia( $\langle\pi_1$(p'), $\pi_2$(p)$\rangle$ , $\langle\pi_1$(p), $\pi_2$(p')$\rangle$)
		ELSE
			{\IF $\pi_2$(p) $<$ $\pi_2$(p') THEN
				distancia( $\langle\pi_1$(p), $\pi_2$(p')$\rangle$, $\langle\pi_1$(p'), $\pi_2$(p)$\rangle$)
			ELSE
				raiz((($\pi_1$(p) - $\pi_1$(p')) $\times$ ($\pi_1$(p) - $\pi_1$(p'))) + (($\pi_2$(p) - 		$\pi_2$(p')) $\times$ ($\pi_2$(p) - $\pi_2$(p'))))
			FI}
		FI}
		
		\tadAxioma{n $\div$ m}{\IF n $<$ m THEN 0 ELSE 1 + ( (n-m) $\div$ m) FI}
		
		\tadAxioma{raiz(n)}{encontrarRaiz(n,n)}
		\tadAxioma{encontrarRaiz(n,m)}{\IF n $<$ m $\times$ m THEN encontrarRaiz(n, pred(m)) ELSE m FI}
		

\end{tad}